<!DOCTYPE html>
<html>
	<title>Internet explorer download</title>
	<head>
		<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		<script type="text/javascript" src="js/internetdownload.js"></script>
	</head>
	<script type="text/javascript">
		var json = '[{"Vehicle":"BMW","Date":"30 Jul 2013 09:24 AM","Location":"Hauz Khas","Speed":42},{"Vehicle":"Honda CBR","Date":"30 Jul 2013 12:00 AM","Location":"Military Road","Speed":0},{"Vehicle":"Supra","Date":"30 Jul 2013 07:53 AM","Location":"Sec-45","Speed":58},{"Vehicle":"Land Cruiser","Date":"30 Jul 2013 09:35 AM","Location":"DLF Phase I","Speed":83}]';
		$(document).ready(function(){
		    $('.download').click(function(){
		        JSONToCSVConvertor(json, true);
		    });	
		});
		function inputFile(file) {
			if( file.type.match(/text\/csv/) || file.type.match(/vnd\.ms-excel/) ){
		    	oFReader = new FileReader();
		        oFReader.onloadend = function() {
		        	var json = csvJSON(this.result);
		        	console.log(json);
		        	var obj = JSON.parse(json);
		        	console.log(obj);
		        };
		        oFReader.readAsText(file);
	        } else {
	        	console.log("This file does not seem to be a CSV.");
	        }
		}

		function initJson () {
			var data = new Object();
			data.tableName = "String(TableName)";
			data.tableType = "String(day;night;both)";
			data.tableField = new Array();
			for (var i = 0;i < 15 ; i++) {
				data.tableField[i] = new Array();
				for (var j = 0 ; j < 6 ; j++) {
					data.tableField[i][j] = new Object();
					data.tableField[i][j].class_name = "String(ClassName)";
					data.tableField[i][j].class_room = "String(ClassRoom)";
					data.tableField[i][j].isRemind = false;
					data.tableField[i][j].remindTime = "dateTime(dateTime)";
					data.tableField[i][j].cellColor	= "Color(#FFFFFF)";
				}
			}
			return data;
		}
		function exportJson() {
			var data = initJson();
			console.log(data);
		}
	</script>
	<body>
		<div align="center">
			<section style="border: solid; padding: 10px;">
				<h3>Example about CSV</h3>
				<button class="download">JSON to CSV  (Download CSV)</button><br><br>
				<form name="csvForm">
					<h3>CSV to JSON</h3>
					<input type="file" name="file" accept=".csv" onchange="inputFile(this.files[0])">
				</form>	
			</section>
			<hr>
			<section style="border: solid; padding: 10px;">
				<h3>Example Json</h3>
				<p>ClassTable json object sample</p>
				<button onclick="exportJson()">Export JSON</button>
			</section>
			
		</div>
	</body>
</html>